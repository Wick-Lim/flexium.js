<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Counter Variations - Flexium Demo</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 2rem;
      color: #333;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      margin-bottom: 2rem;
      color: white;
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 0.5rem;
    }

    .back-link {
      color: white;
      text-decoration: none;
      font-size: 0.95rem;
      opacity: 0.9;
      display: inline-block;
      margin-bottom: 1rem;
    }

    .back-link:hover {
      text-decoration: underline;
    }

    .demos-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 2rem;
    }

    .demo-box {
      background: white;
      border-radius: 16px;
      padding: 2rem;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
    }

    .demo-title {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      color: #1a202c;
    }

    .demo-desc {
      color: #718096;
      margin-bottom: 1.5rem;
      line-height: 1.5;
    }

    .counter-display {
      font-size: 4rem;
      font-weight: 700;
      text-align: center;
      color: #667eea;
      margin: 1.5rem 0;
      min-height: 5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f7fafc;
      border-radius: 12px;
      transition: transform 0.2s ease;
    }

    .counter-display.pulse {
      animation: pulse 0.3s ease;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    .controls {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
      margin-bottom: 1rem;
    }

    button {
      flex: 1;
      min-width: 100px;
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .btn-success {
      background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
      color: white;
    }

    .btn-success:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(67, 233, 123, 0.4);
    }

    .btn-danger {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
    }

    .btn-danger:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(245, 87, 108, 0.4);
    }

    .btn-secondary {
      background: #edf2f7;
      color: #4a5568;
    }

    .btn-secondary:hover:not(:disabled) {
      background: #e2e8f0;
    }

    .info {
      background: #edf2f7;
      padding: 1rem;
      border-radius: 8px;
      font-size: 0.9rem;
      color: #4a5568;
      margin-top: 1rem;
    }

    .info strong {
      color: #2d3748;
    }

    .multi-counter {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .counter-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      background: #f7fafc;
      border-radius: 8px;
    }

    .counter-value {
      font-size: 2rem;
      font-weight: 700;
      color: #667eea;
      min-width: 80px;
      text-align: center;
    }

    .counter-controls {
      display: flex;
      gap: 0.5rem;
      flex: 1;
    }

    .small-btn {
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
    }

    .total-display {
      font-size: 1.5rem;
      font-weight: 700;
      text-align: center;
      color: #38f9d7;
      padding: 1rem;
      background: #1a202c;
      border-radius: 8px;
      margin-top: 1rem;
    }

    @media (max-width: 768px) {
      .demos-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <a href="../index.html" class="back-link">‚Üê Back to Demos</a>
      <h1>Counter Variations</h1>
      <p style="opacity: 0.9;">Exploring different reactive patterns with Flexium signals</p>
    </header>

    <div class="demos-grid">
      <!-- Basic Counter -->
      <div class="demo-box">
        <h2 class="demo-title">1. Basic Counter</h2>
        <p class="demo-desc">Simple counter demonstrating reactive signals and effects.</p>
        <div id="basic-counter" class="counter-display">0</div>
        <div class="controls">
          <button id="basic-dec" class="btn-danger">-</button>
          <button id="basic-inc" class="btn-success">+</button>
          <button id="basic-reset" class="btn-secondary">Reset</button>
        </div>
        <div class="info">
          <strong>Concepts:</strong> signal(), effect(), direct value updates
        </div>
      </div>

      <!-- Computed Counter -->
      <div class="demo-box">
        <h2 class="demo-title">2. Computed Values</h2>
        <p class="demo-desc">Counter with computed derived values (doubled, squared).</p>
        <div class="counter-display" id="computed-display">0</div>
        <div class="controls">
          <button id="computed-inc" class="btn-primary">Increment</button>
        </div>
        <div class="info" id="computed-info">
          <strong>Doubled:</strong> 0 | <strong>Squared:</strong> 0
        </div>
      </div>

      <!-- Async Counter -->
      <div class="demo-box">
        <h2 class="demo-title">3. Async Operations</h2>
        <p class="demo-desc">Counter with delayed async increments and loading state.</p>
        <div id="async-counter" class="counter-display">0</div>
        <div class="controls">
          <button id="async-inc" class="btn-primary">Async +1 (1s)</button>
          <button id="async-reset" class="btn-secondary">Reset</button>
        </div>
        <div class="info" id="async-status">
          <strong>Status:</strong> Ready
        </div>
      </div>

      <!-- Animated Counter -->
      <div class="demo-box">
        <h2 class="demo-title">4. Animated Counter</h2>
        <p class="demo-desc">Counter that animates value changes smoothly.</p>
        <div id="animated-counter" class="counter-display">0</div>
        <div class="controls">
          <button id="animated-inc" class="btn-success">+10</button>
          <button id="animated-dec" class="btn-danger">-10</button>
          <button id="animated-random" class="btn-primary">Random</button>
        </div>
        <div class="info">
          <strong>Features:</strong> Smooth number transitions, visual feedback
        </div>
      </div>

      <!-- Batch Updates -->
      <div class="demo-box">
        <h2 class="demo-title">5. Batched Updates</h2>
        <p class="demo-desc">Multiple counters updated efficiently with batch().</p>
        <div id="batch-display" class="counter-display">0</div>
        <div class="controls">
          <button id="batch-update" class="btn-primary">Update All</button>
          <button id="batch-reset" class="btn-secondary">Reset All</button>
        </div>
        <div class="info" id="batch-info">
          <strong>Effect runs:</strong> 0
        </div>
      </div>

      <!-- Multi Counter -->
      <div class="demo-box">
        <h2 class="demo-title">6. Multi-Counter</h2>
        <p class="demo-desc">Multiple counters with computed total sum.</p>
        <div class="multi-counter">
          <div class="counter-item">
            <div class="counter-value" id="multi-count-1">0</div>
            <div class="counter-controls">
              <button class="btn-danger small-btn" onclick="multiCounterDec(0)">-</button>
              <button class="btn-success small-btn" onclick="multiCounterInc(0)">+</button>
            </div>
          </div>
          <div class="counter-item">
            <div class="counter-value" id="multi-count-2">0</div>
            <div class="counter-controls">
              <button class="btn-danger small-btn" onclick="multiCounterDec(1)">-</button>
              <button class="btn-success small-btn" onclick="multiCounterInc(1)">+</button>
            </div>
          </div>
          <div class="counter-item">
            <div class="counter-value" id="multi-count-3">0</div>
            <div class="counter-controls">
              <button class="btn-danger small-btn" onclick="multiCounterDec(2)">-</button>
              <button class="btn-success small-btn" onclick="multiCounterInc(2)">+</button>
            </div>
          </div>
        </div>
        <div class="total-display" id="multi-total">Total: 0</div>
        <div class="info">
          <strong>Concepts:</strong> Array of signals, computed sum, reactive totals
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    import { signal, computed, effect, batch } from '../../dist/index.mjs';

    // 1. Basic Counter
    const basicCount = signal(0);
    effect(() => {
      const el = document.getElementById('basic-counter');
      el.textContent = basicCount.value;
      el.classList.add('pulse');
      setTimeout(() => el.classList.remove('pulse'), 300);
    });

    document.getElementById('basic-inc').onclick = () => basicCount.value++;
    document.getElementById('basic-dec').onclick = () => basicCount.value--;
    document.getElementById('basic-reset').onclick = () => basicCount.value = 0;

    // 2. Computed Counter
    const computedCount = signal(0);
    const doubled = computed(() => computedCount.value * 2);
    const squared = computed(() => computedCount.value ** 2);

    effect(() => {
      document.getElementById('computed-display').textContent = computedCount.value;
    });

    effect(() => {
      document.getElementById('computed-info').innerHTML =
        `<strong>Doubled:</strong> ${doubled.value} | <strong>Squared:</strong> ${squared.value}`;
    });

    document.getElementById('computed-inc').onclick = () => computedCount.value++;

    // 3. Async Counter
    const asyncCount = signal(0);
    const asyncLoading = signal(false);

    effect(() => {
      document.getElementById('async-counter').textContent = asyncCount.value;
    });

    effect(() => {
      const status = asyncLoading.value ? 'Loading...' : 'Ready';
      document.getElementById('async-status').innerHTML = `<strong>Status:</strong> ${status}`;
    });

    document.getElementById('async-inc').onclick = async () => {
      if (asyncLoading.value) return;
      asyncLoading.value = true;
      document.getElementById('async-inc').disabled = true;

      await new Promise(resolve => setTimeout(resolve, 1000));

      asyncCount.value++;
      asyncLoading.value = false;
      document.getElementById('async-inc').disabled = false;
    };

    document.getElementById('async-reset').onclick = () => asyncCount.value = 0;

    // 4. Animated Counter
    const animatedCount = signal(0);
    let currentDisplayValue = 0;

    effect(() => {
      const target = animatedCount.value;
      const el = document.getElementById('animated-counter');

      const animate = () => {
        const diff = target - currentDisplayValue;
        if (Math.abs(diff) < 0.1) {
          currentDisplayValue = target;
          el.textContent = Math.round(currentDisplayValue);
          return;
        }
        currentDisplayValue += diff * 0.15;
        el.textContent = Math.round(currentDisplayValue);
        requestAnimationFrame(animate);
      };

      animate();
    });

    document.getElementById('animated-inc').onclick = () => animatedCount.value += 10;
    document.getElementById('animated-dec').onclick = () => animatedCount.value -= 10;
    document.getElementById('animated-random').onclick = () =>
      animatedCount.value = Math.floor(Math.random() * 100);

    // 5. Batched Updates
    const batchA = signal(0);
    const batchB = signal(0);
    const batchC = signal(0);
    const batchSum = computed(() => batchA.value + batchB.value + batchC.value);
    let effectRuns = 0;

    effect(() => {
      effectRuns++;
      document.getElementById('batch-display').textContent = batchSum.value;
      document.getElementById('batch-info').innerHTML =
        `<strong>Effect runs:</strong> ${effectRuns}`;
    });

    document.getElementById('batch-update').onclick = () => {
      batch(() => {
        batchA.value++;
        batchB.value += 2;
        batchC.value += 3;
      }); // Effect runs only once!
    };

    document.getElementById('batch-reset').onclick = () => {
      batch(() => {
        batchA.value = 0;
        batchB.value = 0;
        batchC.value = 0;
      });
    };

    // 6. Multi-Counter
    const counters = [signal(0), signal(0), signal(0)];
    const total = computed(() => counters.reduce((sum, c) => sum + c.value, 0));

    counters.forEach((counter, i) => {
      effect(() => {
        document.getElementById(`multi-count-${i + 1}`).textContent = counter.value;
      });
    });

    effect(() => {
      document.getElementById('multi-total').textContent = `Total: ${total.value}`;
    });

    window.multiCounterInc = (index) => counters[index].value++;
    window.multiCounterDec = (index) => counters[index].value--;
  </script>
</body>
</html>
